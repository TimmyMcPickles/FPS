[gd_scene load_steps=16 format=3 uid="uid://c7x033y4kqr8q"]

[ext_resource type="PackedScene" uid="uid://dbfdkv62b7gbl" path="res://models/guy/guyV1.glb" id="1_4ra3w"]
[ext_resource type="Script" uid="uid://bwy0h5qjki362" path="res://src/enemy.gd" id="1_5uy6h"]
[ext_resource type="Shader" uid="uid://cb4oajhgi3ms0" path="res://shaders/psx.gdshader" id="1_md0e3"]
[ext_resource type="PackedScene" uid="uid://bsn4cita3mqm3" path="res://scenes/hitbox.tscn" id="2_c4w8v"]
[ext_resource type="PackedScene" uid="uid://kg0le4ychii" path="res://scenes/hurtbox.tscn" id="3_xwavj"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_reen0"]

[sub_resource type="BoxShape3D" id="BoxShape3D_c4w8v"]
size = Vector3(1, 1.8, 0.4)

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_xwavj"]
radius = 0.15
height = 0.4

[sub_resource type="ShaderMaterial" id="ShaderMaterial_5uy6h"]
render_priority = 0
shader = ExtResource("1_md0e3")
shader_parameter/paletteswap = false
shader_parameter/snapRes = 50.0

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_5uy6h"]
animation = &"punch"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_4ra3w"]
animation = &"walk"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_5uy6h"]
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_c4w8v"]
xfade_time = 0.2
advance_mode = 2
advance_condition = &"attack"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_xwavj"]
xfade_time = 0.2
switch_mode = 2
advance_mode = 2
advance_condition = &"run"

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_c4w8v"]
states/punch/node = SubResource("AnimationNodeAnimation_5uy6h")
states/punch/position = Vector2(463, 101)
states/walk/node = SubResource("AnimationNodeAnimation_4ra3w")
states/walk/position = Vector2(332, 101)
transitions = ["Start", "walk", SubResource("AnimationNodeStateMachineTransition_5uy6h"), "walk", "punch", SubResource("AnimationNodeStateMachineTransition_c4w8v"), "punch", "walk", SubResource("AnimationNodeStateMachineTransition_xwavj")]
graph_offset = Vector2(53, -51)

[node name="Enemy" type="CharacterBody3D"]
collision_layer = 4
collision_mask = 7
script = ExtResource("1_5uy6h")

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
shape = SubResource("CapsuleShape3D_reen0")

[node name="hitbox" parent="." instance=ExtResource("2_c4w8v")]
collision_layer = 4
collision_mask = 2

[node name="CollisionShape3D" parent="hitbox" index="0"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.12471, -0.938933)

[node name="hurtbox" parent="." instance=ExtResource("3_xwavj")]
collision_layer = 4
collision_mask = 10

[node name="CollisionShape3D" parent="hurtbox" index="0"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.854201, 0)
shape = SubResource("BoxShape3D_c4w8v")

[node name="head_hurtbox" parent="." instance=ExtResource("3_xwavj")]
collision_layer = 4
collision_mask = 10

[node name="CollisionShape3D" parent="head_hurtbox" index="0"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.93482, -0.0404822)
shape = SubResource("CapsuleShape3D_xwavj")

[node name="Character_Base" parent="." instance=ExtResource("1_4ra3w")]
transform = Transform3D(-1, 0, -8.74228e-08, 0, 1, 0, 8.74228e-08, 0, -1, 0, 0, 0)

[node name="Skeleton3D" parent="Character_Base/rig" index="0"]
bones/1/position = Vector3(-0.00564659, -0.13669, 1.00729)
bones/1/rotation = Quaternion(0.656421, -0.0546328, -0.0654409, 0.749563)
bones/2/rotation = Quaternion(0.0200442, 0.000775316, -0.00107272, 0.999798)
bones/2/scale = Vector3(0.990728, 1.01881, 0.990728)
bones/3/rotation = Quaternion(0.19161, 0.0646207, -0.00666976, 0.979319)
bones/3/scale = Vector3(0.893459, 1.25899, 0.890021)
bones/4/rotation = Quaternion(-0.1433, 0.0834994, -0.00692608, 0.986126)
bones/4/scale = Vector3(1.12952, 0.814544, 1.10898)
bones/5/rotation = Quaternion(0.217207, -0.0308122, 0.00704354, 0.975614)
bones/5/scale = Vector3(1, 1, 1)
bones/6/rotation = Quaternion(-0.092573, 1.80902e-07, 4.41471e-07, 0.995706)
bones/6/scale = Vector3(0.999999, 1, 0.999999)
bones/7/rotation = Quaternion(-0.115267, -0.0310685, 0.00570255, 0.992832)
bones/7/scale = Vector3(1, 0.999998, 1)
bones/8/position = Vector3(0.359209, 0.00922134, 1.4791)
bones/8/rotation = Quaternion(-0.00645345, 0.989154, 0.00289561, 0.146714)
bones/8/scale = Vector3(1, 18.1672, 1)
bones/9/position = Vector3(-0.341519, -0.184707, 1.43727)
bones/9/rotation = Quaternion(-0.136813, 0.990181, 0.0278212, -0.00711718)
bones/9/scale = Vector3(1, 21.0588, 1)
bones/10/position = Vector3(0.21377, -0.422074, 0.753515)
bones/10/rotation = Quaternion(0.800963, 0.308351, -0.500987, -0.111314)
bones/10/scale = Vector3(1, 13.723, 1)
bones/11/position = Vector3(-0.149037, 0.068869, 0.615662)
bones/11/rotation = Quaternion(0.780076, -0.297499, 0.542079, 0.0955347)
bones/11/scale = Vector3(1, 21.0754, 1)
bones/14/position = Vector3(0.00146018, -0.0849856, 0.244973)
bones/14/rotation = Quaternion(0.0987921, -0.00707866, -0.0850007, 0.991446)
bones/15/position = Vector3(0.00146018, -0.0849856, 0.244973)
bones/15/rotation = Quaternion(0.0440699, 0, 0, 0.999028)
bones/16/position = Vector3(0.00146018, -0.0375679, 0.223276)
bones/16/rotation = Quaternion(0.0495016, -0.00354685, -0.0425906, 0.997859)
bones/18/position = Vector3(-0.000232159, -0.103925, 0.0446684)
bones/18/rotation = Quaternion(-0.711173, -0.0374629, -0.0216647, 0.701683)
bones/19/rotation = Quaternion(0.580936, 0.000471664, -0.000417046, 0.813949)
bones/26/rotation = Quaternion(0.933059, 0.124941, -0.151801, 0.301242)
bones/26/scale = Vector3(0.966064, 0.966065, 0.966065)
bones/27/rotation = Quaternion(0.683027, -1.74458e-08, -6.12289e-09, 0.730393)
bones/27/scale = Vector3(0.999618, 0.999619, 0.999618)
bones/28/rotation = Quaternion(-0.252554, 0.0928414, -0.0394456, 0.96231)
bones/28/scale = Vector3(1.03645, 1.03645, 1.03645)
bones/29/position = Vector3(-0.00142607, 0.25464, -0.0178971)
bones/29/rotation = Quaternion(-0.0358198, 0.978729, -0.201874, -0.00737506)
bones/33/scale = Vector3(1.03645, 1.03645, 1.03645)
bones/35/rotation = Quaternion(-7.86154e-08, 0.047222, -1.59365e-08, 0.998884)
bones/35/scale = Vector3(1.03645, 1.03645, 1.03645)
bones/37/scale = Vector3(1.03513, 1.03513, 1.03513)
bones/38/rotation = Quaternion(-2.86823e-09, 0.0242264, -2.70599e-09, 0.999707)
bones/38/scale = Vector3(1.03513, 1.03513, 1.03513)
bones/40/position = Vector3(-0.120967, 0.0662979, -0.0243575)
bones/40/rotation = Quaternion(0.954965, -0.0992789, 0.193033, -0.202295)
bones/40/scale = Vector3(1.04425, 1.04425, 1.04425)
bones/41/rotation = Quaternion(0.00147776, -9.37045e-08, 5.5048e-09, 0.999999)
bones/41/scale = Vector3(0.999268, 0.999268, 0.999268)
bones/42/rotation = Quaternion(-0.60957, -0.172602, -0.191753, 0.749576)
bones/42/scale = Vector3(0.95831, 0.95831, 0.958309)
bones/43/position = Vector3(-9.90093e-06, 0.241448, 0.000178827)
bones/47/scale = Vector3(0.95831, 0.95831, 0.95831)
bones/49/rotation = Quaternion(-7.85236e-08, -0.0981771, 3.8066e-08, 0.995169)
bones/49/scale = Vector3(0.95831, 0.95831, 0.95831)
bones/51/scale = Vector3(0.957706, 0.957705, 0.957705)
bones/52/rotation = Quaternion(4.42223e-07, -0.000858104, -1.39704e-06, 1)
bones/52/scale = Vector3(0.957705, 0.957703, 0.957703)
bones/54/rotation = Quaternion(0.972741, 0.0866944, 0.120624, -0.178068)
bones/60/rotation = Quaternion(-0.0358198, 0.978728, -0.201874, -0.00737491)
bones/62/rotation = Quaternion(-0.75573, -0.168651, 0.1323, 0.618809)
bones/63/rotation = Quaternion(-0.370208, 0.0172028, 0.00685714, 0.928764)
bones/63/scale = Vector3(0.966064, 0.966065, 0.966065)
bones/64/rotation = Quaternion(0.683027, -1.92405e-08, -4.34539e-09, 0.730393)
bones/64/scale = Vector3(0.999618, 0.999619, 0.999618)
bones/65/rotation = Quaternion(0.938563, 0.137675, -0.112576, 0.295757)
bones/67/rotation = Quaternion(0.938563, 0.137675, -0.112576, 0.295757)
bones/67/scale = Vector3(1.01741, 0.966065, 1.01741)
bones/68/rotation = Quaternion(-2.98545e-08, -0.017735, -2.93543e-08, 0.999843)
bones/69/rotation = Quaternion(0.682795, -0.0176912, 0.0164911, 0.730209)
bones/69/scale = Vector3(1.00064, 0.948741, 1.0534)
bones/70/rotation = Quaternion(7.4463e-08, -0.00727264, 4.99168e-08, 0.999974)
bones/71/rotation = Quaternion(-0.285972, 0.104683, -0.0322289, 0.951957)
bones/71/scale = Vector3(0.955768, 1.07932, 0.970577)
bones/72/rotation = Quaternion(-0.0334167, 0.985226, -0.167833, -0.00673089)
bones/72/scale = Vector3(1.02816, 0.955152, 1.01974)
bones/73/rotation = Quaternion(0.972881, -0.0854502, -0.120567, -0.177944)
bones/81/rotation = Quaternion(-0.657337, 0.20666, -0.11141, 0.716092)
bones/82/position = Vector3(1.69966e-08, -1.17347e-07, 5.14556e-08)
bones/82/rotation = Quaternion(-0.000808063, -0.018519, -1.49574e-05, 0.999828)
bones/82/scale = Vector3(1.04425, 1.04425, 1.04425)
bones/83/rotation = Quaternion(0.00147776, -9.83854e-08, 1.00047e-09, 0.999999)
bones/83/scale = Vector3(0.999268, 0.999268, 0.999268)
bones/84/position = Vector3(-0.120967, 0.0662978, -0.0243575)
bones/84/rotation = Quaternion(0.955209, -0.0990257, 0.191822, -0.20242)
bones/86/position = Vector3(-0.120967, 0.0662979, -0.0243574)
bones/86/rotation = Quaternion(0.955209, -0.0990257, 0.191822, -0.20242)
bones/86/scale = Vector3(0.978614, 1.04425, 0.978614)
bones/87/rotation = Quaternion(-2.18161e-08, 0.000857014, 1.6876e-08, 1)
bones/87/scale = Vector3(0.999983, 1, 0.999951)
bones/88/rotation = Quaternion(0.00147939, 0.000634156, -1.24186e-06, 0.999999)
bones/88/scale = Vector3(1.00005, 0.99971, 1.00024)
bones/89/rotation = Quaternion(-3.71903e-10, -0.0438091, 8.08896e-09, 0.99904)
bones/90/rotation = Quaternion(-0.616862, -0.13985, -0.164853, 0.756801)
bones/90/scale = Vector3(1.02111, 1.01963, 0.960841)
bones/91/rotation = Quaternion(0.0358371, 0.978653, -0.202237, 0.00738431)
bones/91/scale = Vector3(1.00024, 0.999636, 1.00013)
bones/95/position = Vector3(0.00146018, -0.0375679, 0.223276)
bones/95/rotation = Quaternion(0.0220403, 0, 0, 0.999757)
bones/96/position = Vector3(-1.48359e-07, -0.0173238, 0.0442137)
bones/96/rotation = Quaternion(0.711663, -0.00240419, 0.00284283, 0.702511)
bones/97/position = Vector3(-0.000159093, -0.0222165, -0.00837517)
bones/97/rotation = Quaternion(0.0637684, -0.0218589, -0.00535059, 0.997711)
bones/98/rotation = Quaternion(-0.0500164, 0.000806133, 0.00893315, 0.998708)
bones/100/position = Vector3(0.000133948, 0.206675, 0.047133)
bones/100/rotation = Quaternion(-0.696006, 0.00234095, -0.00289513, 0.718026)
bones/101/position = Vector3(-1.7971e-11, 9.02679e-09, 1.08236e-07)
bones/101/rotation = Quaternion(0.681894, 0.0471785, 0.0419789, 0.72872)
bones/102/rotation = Quaternion(0.217207, -0.0308122, 0.00704354, 0.975614)
bones/102/scale = Vector3(1, 1, 1)
bones/103/rotation = Quaternion(-0.092573, 1.80857e-07, 4.41418e-07, 0.995706)
bones/103/scale = Vector3(0.999999, 1, 0.999999)
bones/104/rotation = Quaternion(-0.115267, -0.0310685, 0.00570255, 0.992832)
bones/104/scale = Vector3(1, 0.999998, 1)
bones/105/rotation = Quaternion(-0.698824, -0.0227228, -0.0219701, 0.714595)
bones/106/rotation = Quaternion(0.811797, 2.76976e-07, 6.24089e-08, 0.58394)
bones/107/rotation = Quaternion(-0.824045, -0.026441, -0.0172812, 0.565643)
bones/108/position = Vector3(-1.15906e-10, 1.74131e-08, 6.15045e-08)
bones/108/rotation = Quaternion(0.722241, -1.67647e-07, -6.77814e-08, 0.691641)
bones/110/rotation = Quaternion(-2.08849e-07, -1.35333e-09, 2.85215e-09, 1)
bones/111/rotation = Quaternion(0.0108196, -2.62744e-10, -2.71807e-13, 0.999941)
bones/111/scale = Vector3(1, 0.999999, 1)
bones/115/rotation = Quaternion(-0.460104, -0.513263, -0.459437, 0.560164)
bones/116/rotation = Quaternion(-0.457036, 0.649529, -0.385857, 0.469409)
bones/116/scale = Vector3(0.984041, 0.984041, 0.984041)
bones/117/rotation = Quaternion(0.352726, 1.64022e-07, -1.3157e-07, 0.935727)
bones/117/scale = Vector3(0.998756, 0.998756, 0.998756)
bones/118/rotation = Quaternion(-0.0814246, 0.0334663, -0.163485, 0.98261)
bones/118/scale = Vector3(1.01734, 1.01734, 1.01734)
bones/121/scale = Vector3(1.01734, 1.01734, 1.01734)
bones/123/rotation = Quaternion(-2.45474e-07, 0.0168782, -2.18018e-07, 0.999858)
bones/123/scale = Vector3(1.01734, 1.01734, 1.01734)
bones/125/scale = Vector3(1.01623, 1.01623, 1.01623)
bones/126/rotation = Quaternion(1.85958e-07, 0.00177159, -3.16705e-08, 0.999998)
bones/126/scale = Vector3(1.01623, 1.01623, 1.01623)
bones/135/rotation = Quaternion(-0.178939, -0.656465, 0.724835, -0.107929)
bones/136/rotation = Quaternion(-0.174228, 0.00384796, 0.000680881, 0.984698)
bones/136/scale = Vector3(0.984041, 0.984041, 0.984041)
bones/137/rotation = Quaternion(0.352726, 1.66489e-07, -1.31094e-07, 0.935727)
bones/137/scale = Vector3(0.998756, 0.998756, 0.998756)
bones/138/rotation = Quaternion(-0.4558, 0.651077, -0.387452, 0.467146)
bones/140/rotation = Quaternion(-0.4558, 0.651077, -0.387453, 0.467146)
bones/140/scale = Vector3(1.00808, 0.984041, 1.00808)
bones/141/rotation = Quaternion(7.599e-08, -0.00162967, 1.70384e-08, 0.999999)
bones/142/rotation = Quaternion(0.352714, -0.0016232, 0.000687077, 0.93573)
bones/142/scale = Vector3(1.00055, 0.987718, 1.01221)
bones/143/rotation = Quaternion(-6.71163e-08, 0.0134046, -2.19919e-08, 0.99991)
bones/144/rotation = Quaternion(-0.0793518, 0.0198221, -0.164687, 0.982949)
bones/144/scale = Vector3(0.994314, 1.01386, 0.992146)
bones/145/rotation = Quaternion(-0.460295, 0.513086, 0.459608, 0.560029)
bones/146/rotation = Quaternion(-0.412294, -0.569756, 0.503124, 0.502252)
bones/146/scale = Vector3(0.992096, 0.992095, 0.992096)
bones/147/rotation = Quaternion(0.1901, -2.83651e-07, 7.37068e-08, 0.981765)
bones/147/scale = Vector3(0.999182, 0.999182, 0.999182)
bones/148/rotation = Quaternion(-0.237919, 0.0459443, 0.134779, 0.960791)
bones/148/scale = Vector3(1.00846, 1.00846, 1.00846)
bones/151/scale = Vector3(1.00846, 1.00846, 1.00846)
bones/153/rotation = Quaternion(-1.58471e-07, 0.023443, 1.7441e-07, 0.999725)
bones/153/scale = Vector3(1.00846, 1.00846, 1.00846)
bones/155/scale = Vector3(1.00797, 1.00797, 1.00797)
bones/156/rotation = Quaternion(7.05044e-08, 0.00227769, -5.65828e-08, 0.999997)
bones/156/scale = Vector3(1.00797, 1.00797, 1.00797)
bones/165/rotation = Quaternion(0.149795, -0.619152, 0.768485, 0.060357)
bones/166/rotation = Quaternion(-0.0929136, -0.00389077, -0.000363181, 0.995667)
bones/166/scale = Vector3(0.992096, 0.992096, 0.992096)
bones/167/rotation = Quaternion(0.1901, -2.7926e-07, 7.62245e-08, 0.981765)
bones/167/scale = Vector3(0.999182, 0.999182, 0.999182)
bones/168/rotation = Quaternion(-0.414749, -0.5673, 0.501089, 0.505038)
bones/170/rotation = Quaternion(-0.414749, -0.5673, 0.501089, 0.505038)
bones/170/scale = Vector3(1.00393, 0.99218, 1.00393)
bones/171/rotation = Quaternion(-5.80577e-09, -0.00224543, -7.58463e-09, 0.999997)
bones/172/rotation = Quaternion(0.190108, -0.00242405, 0.000458608, 0.98176)
bones/172/scale = Vector3(1.00024, 0.997838, 1.00196)
bones/173/rotation = Quaternion(-2.97725e-08, 0.0269159, 8.68627e-08, 0.999638)
bones/174/rotation = Quaternion(-0.241597, 0.0204976, 0.128097, 0.961666)
bones/174/scale = Vector3(0.996545, 1.0049, 0.99865)
bones/175/rotation = Quaternion(-0.460104, -0.513263, -0.459437, 0.560164)
bones/176/rotation = Quaternion(-0.460295, 0.513086, 0.459608, 0.560029)
bones/179/position = Vector3(-0.0108248, -0.0500598, 0.148586)
bones/179/rotation = Quaternion(-0.0894247, -0.646698, 0.757023, 0.026482)
bones/181/position = Vector3(0.350791, 1.48255, -0.695779)
bones/181/rotation = Quaternion(-0.673911, 0.0465874, 0.0425993, 0.73611)
bones/184/position = Vector3(0.0913019, -0.24935, 0.0862592)
bones/184/rotation = Quaternion(0.0781272, -0.761104, 0.64194, -0.0503023)
bones/186/position = Vector3(-0.556982, 1.48262, -0.580476)
bones/186/rotation = Quaternion(-0.673911, 0.0465874, 0.0425994, 0.73611)
bones/187/rotation = Quaternion(-0.337003, 5.05357e-08, 0.939611, -0.0596658)
bones/189/position = Vector3(-0.1005, -0.177987, 0.297837)
bones/189/rotation = Quaternion(0.643236, 0, 0, 0.765668)
bones/196/rotation = Quaternion(0.978729, 0.0358198, -0.00737504, -0.201874)
bones/200/position = Vector3(0.457272, 0.441329, 0.925225)
bones/200/rotation = Quaternion(-0.631202, -0.0651099, -0.0550993, 0.770915)
bones/203/position = Vector3(0.1005, 0.170997, 0.031155)
bones/203/rotation = Quaternion(0.0495799, 0, 0, 0.99877)
bones/210/rotation = Quaternion(0.978729, -0.0358198, 0.00737505, -0.201874)
bones/213/rotation = Quaternion(1.351e-07, -7.45058e-09, 1, -2.54614e-15)
bones/214/position = Vector3(-0.708486, 0.444537, 0.724191)
bones/214/rotation = Quaternion(-0.631202, -0.0651099, -0.0550993, 0.770915)

[node name="Cube" parent="Character_Base/rig/Skeleton3D" index="0"]
material_override = SubResource("ShaderMaterial_5uy6h")

[node name="NavigationAgent3D" type="NavigationAgent3D" parent="."]
path_height_offset = 0.5

[node name="AnimationTree" type="AnimationTree" parent="."]
root_node = NodePath("../Character_Base")
tree_root = SubResource("AnimationNodeStateMachine_c4w8v")
anim_player = NodePath("../Character_Base/AnimationPlayer")
parameters/conditions/attack = false
parameters/conditions/run = false

[connection signal="area_entered" from="hurtbox" to="." method="_on_hurtbox_area_entered"]
[connection signal="area_entered" from="head_hurtbox" to="." method="_on_head_hurtbox_area_entered"]

[editable path="hitbox"]
[editable path="hurtbox"]
[editable path="head_hurtbox"]
[editable path="Character_Base"]
