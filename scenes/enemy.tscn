[gd_scene load_steps=16 format=3 uid="uid://c7x033y4kqr8q"]

[ext_resource type="PackedScene" uid="uid://dbfdkv62b7gbl" path="res://models/guy/guyV1.glb" id="1_4ra3w"]
[ext_resource type="Script" uid="uid://bwy0h5qjki362" path="res://src/enemy.gd" id="1_5uy6h"]
[ext_resource type="Shader" uid="uid://cb4oajhgi3ms0" path="res://shaders/psx.gdshader" id="1_md0e3"]
[ext_resource type="PackedScene" uid="uid://bsn4cita3mqm3" path="res://scenes/hitbox.tscn" id="2_c4w8v"]
[ext_resource type="PackedScene" uid="uid://kg0le4ychii" path="res://scenes/hurtbox.tscn" id="3_xwavj"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_reen0"]

[sub_resource type="BoxShape3D" id="BoxShape3D_c4w8v"]
size = Vector3(1, 1.8, 0.4)

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_xwavj"]
radius = 0.15
height = 0.4

[sub_resource type="ShaderMaterial" id="ShaderMaterial_5uy6h"]
render_priority = 0
shader = ExtResource("1_md0e3")
shader_parameter/paletteswap = false
shader_parameter/snapRes = 50.0

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_5uy6h"]
animation = &"punch"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_4ra3w"]
animation = &"walk"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_5uy6h"]
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_c4w8v"]
xfade_time = 0.2
advance_mode = 2
advance_condition = &"attack"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_xwavj"]
xfade_time = 0.2
switch_mode = 2
advance_mode = 2
advance_condition = &"run"

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_c4w8v"]
states/punch/node = SubResource("AnimationNodeAnimation_5uy6h")
states/punch/position = Vector2(463, 101)
states/walk/node = SubResource("AnimationNodeAnimation_4ra3w")
states/walk/position = Vector2(332, 101)
transitions = ["Start", "walk", SubResource("AnimationNodeStateMachineTransition_5uy6h"), "walk", "punch", SubResource("AnimationNodeStateMachineTransition_c4w8v"), "punch", "walk", SubResource("AnimationNodeStateMachineTransition_xwavj")]
graph_offset = Vector2(53, -51)

[node name="Enemy" type="CharacterBody3D"]
collision_layer = 4
collision_mask = 7
script = ExtResource("1_5uy6h")

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
shape = SubResource("CapsuleShape3D_reen0")

[node name="hitbox" parent="." instance=ExtResource("2_c4w8v")]
collision_layer = 4
collision_mask = 2

[node name="CollisionShape3D" parent="hitbox" index="0"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.12471, -0.938933)

[node name="hurtbox" parent="." instance=ExtResource("3_xwavj")]
collision_layer = 4
collision_mask = 10

[node name="CollisionShape3D" parent="hurtbox" index="0"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.854201, 0)
shape = SubResource("BoxShape3D_c4w8v")

[node name="head_hurtbox" parent="." instance=ExtResource("3_xwavj")]
collision_layer = 4
collision_mask = 10

[node name="CollisionShape3D" parent="head_hurtbox" index="0"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.93482, -0.0404822)
shape = SubResource("CapsuleShape3D_xwavj")

[node name="Character_Base" parent="." instance=ExtResource("1_4ra3w")]
transform = Transform3D(-1, 0, -8.74228e-08, 0, 1, 0, 8.74228e-08, 0, -1, 0, 0, 0)

[node name="Skeleton3D" parent="Character_Base/rig" index="0"]
bones/1/position = Vector3(0.00314145, -0.0892804, 0.963298)
bones/1/rotation = Quaternion(0.702918, 0.0121208, 0.0230595, 0.710794)
bones/2/rotation = Quaternion(-0.00151454, 0.0028568, -0.00984338, 0.999946)
bones/2/scale = Vector3(0.995553, 1.00895, 0.995553)
bones/3/rotation = Quaternion(0.135762, -0.0202914, 0.0102617, 0.990481)
bones/3/scale = Vector3(0.992982, 1.01518, 0.992034)
bones/4/rotation = Quaternion(-0.117863, -0.0907407, 0.00680894, 0.988852)
bones/4/scale = Vector3(1.01152, 0.979183, 1.00975)
bones/5/rotation = Quaternion(0.217126, 0.0413496, -0.00902329, 0.975226)
bones/5/scale = Vector3(1, 1, 1)
bones/6/rotation = Quaternion(-0.092573, 1.80902e-07, 4.41471e-07, 0.995706)
bones/6/scale = Vector3(0.999999, 1, 0.999999)
bones/7/rotation = Quaternion(-0.115204, 0.0416502, -0.00761882, 0.992439)
bones/7/scale = Vector3(1, 0.999998, 1)
bones/8/position = Vector3(0.38365, -0.225605, 1.3771)
bones/8/rotation = Quaternion(0.122384, 0.992257, 0.00902176, 0.0191818)
bones/8/scale = Vector3(1, 22.3921, 1)
bones/9/position = Vector3(-0.316903, 0.170918, 1.44569)
bones/9/rotation = Quaternion(0.00932938, 0.988767, -0.0416885, -0.143232)
bones/9/scale = Vector3(1, 15.3671, 1)
bones/10/position = Vector3(0.176817, 0.115278, 0.609679)
bones/10/rotation = Quaternion(0.803761, 0.291966, -0.518343, 0.00668283)
bones/10/scale = Vector3(1, 20.6018, 1)
bones/11/position = Vector3(-0.149104, -0.28115, 0.578675)
bones/11/rotation = Quaternion(0.700309, -0.389338, 0.596809, 0.0424476)
bones/11/scale = Vector3(1, 14.2293, 1)
bones/14/position = Vector3(0.00146018, -0.06551, 0.201578)
bones/14/rotation = Quaternion(0.159229, -0.00415871, 0.0257755, 0.986896)
bones/15/position = Vector3(0.00146018, -0.06551, 0.201578)
bones/15/rotation = Quaternion(0.0440699, 0, 0, 0.999028)
bones/16/position = Vector3(0.00146018, -0.02783, 0.201578)
bones/16/rotation = Quaternion(0.0798768, -0.0020862, 0.0129302, 0.996719)
bones/18/position = Vector3(-3.3047e-06, -0.126581, 0.0374395)
bones/18/rotation = Quaternion(-0.690294, 0.00504532, 0.0143274, 0.72337)
bones/19/rotation = Quaternion(0.580936, 0.000471664, -0.000417046, 0.813949)
bones/26/rotation = Quaternion(0.959563, 0.10042, -0.192781, -0.17886)
bones/26/scale = Vector3(0.997662, 0.997663, 0.997663)
bones/27/rotation = Quaternion(0.123779, -2.32773e-08, -2.20682e-09, 0.99231)
bones/27/scale = Vector3(0.999905, 0.999905, 0.999905)
bones/28/rotation = Quaternion(-0.574843, 0.163221, 0.125421, 0.791949)
bones/28/scale = Vector3(1.00232, 1.00232, 1.00232)
bones/29/position = Vector3(-0.00142607, 0.25464, -0.0178971)
bones/29/rotation = Quaternion(-0.0358198, 0.978729, -0.201874, -0.00737506)
bones/33/scale = Vector3(1.00232, 1.00232, 1.00232)
bones/35/rotation = Quaternion(-1.09584e-07, 0.09071, -9.72093e-09, 0.995877)
bones/35/scale = Vector3(1.00232, 1.00232, 1.00232)
bones/37/scale = Vector3(1.00234, 1.00234, 1.00234)
bones/38/rotation = Quaternion(5.06543e-07, 0.00192834, 1.2385e-09, 0.999998)
bones/38/scale = Vector3(1.00234, 1.00234, 1.00234)
bones/40/position = Vector3(-0.120967, 0.0662979, -0.0243575)
bones/40/rotation = Quaternion(0.963805, -0.0135315, 0.15674, 0.215244)
bones/40/scale = Vector3(1.07887, 1.07887, 1.07887)
bones/41/rotation = Quaternion(7.01249e-05, -8.04867e-08, 1.4602e-08, 1)
bones/41/scale = Vector3(0.999079, 0.999079, 0.999079)
bones/42/rotation = Quaternion(-0.472826, -0.0727867, -0.0658869, 0.875669)
bones/42/scale = Vector3(0.927925, 0.927924, 0.927924)
bones/43/position = Vector3(-9.90093e-06, 0.241448, 0.000178827)
bones/47/scale = Vector3(0.927925, 0.927924, 0.927925)
bones/49/rotation = Quaternion(-1.55006e-07, -0.0387765, 4.38861e-08, 0.999248)
bones/49/scale = Vector3(0.927925, 0.927924, 0.927924)
bones/51/scale = Vector3(0.926899, 0.926898, 0.926899)
bones/52/rotation = Quaternion(2.81754e-07, -0.00479176, -1.80739e-06, 0.999989)
bones/52/scale = Vector3(0.926898, 0.926868, 0.926869)
bones/54/rotation = Quaternion(0.972741, 0.0866944, 0.120624, -0.178068)
bones/60/rotation = Quaternion(-0.0358198, 0.978728, -0.201874, -0.00737491)
bones/62/rotation = Quaternion(-0.629651, -0.200431, 0.12252, 0.74051)
bones/63/rotation = Quaternion(-0.0624848, 0.0184829, 0.00115726, 0.997874)
bones/63/scale = Vector3(0.997663, 0.997663, 0.997663)
bones/64/rotation = Quaternion(0.123779, -1.43798e-08, -3.02202e-10, 0.99231)
bones/64/scale = Vector3(0.999905, 0.999905, 0.999904)
bones/65/rotation = Quaternion(0.960205, 0.0998178, -0.189555, -0.179197)
bones/67/rotation = Quaternion(0.960205, 0.0998177, -0.189555, -0.179197)
bones/67/scale = Vector3(1.00117, 0.997663, 1.00117)
bones/68/rotation = Quaternion(-8.38173e-09, -0.00181337, -4.47807e-08, 0.999998)
bones/69/rotation = Quaternion(0.123779, -0.00167408, 0.000208188, 0.992308)
bones/69/scale = Vector3(0.999988, 0.999814, 1.0002)
bones/70/rotation = Quaternion(7.8947e-08, 0.0363146, -3.07729e-08, 0.99934)
bones/71/rotation = Quaternion(-0.606257, 0.132217, 0.111314, 0.776261)
bones/71/scale = Vector3(0.971186, 1.05675, 0.974369)
bones/72/rotation = Quaternion(-0.0334167, 0.985226, -0.167833, -0.00673089)
bones/72/scale = Vector3(1.02816, 0.955152, 1.01974)
bones/73/rotation = Quaternion(0.972881, -0.0854502, -0.120567, -0.177944)
bones/81/rotation = Quaternion(-0.907236, 0.109476, -0.135998, 0.382679)
bones/82/position = Vector3(1.69966e-08, -1.17347e-07, 5.14556e-08)
bones/82/rotation = Quaternion(-3.52948e-05, -0.0185191, -6.64033e-07, 0.999829)
bones/82/scale = Vector3(1.07887, 1.07887, 1.07887)
bones/83/rotation = Quaternion(7.01249e-05, -7.91232e-08, 1.53659e-08, 1)
bones/83/scale = Vector3(0.999079, 0.999079, 0.999079)
bones/84/position = Vector3(-0.120967, 0.0662978, -0.0243575)
bones/84/rotation = Quaternion(0.965261, -0.0155913, 0.147506, 0.215105)
bones/86/position = Vector3(-0.120967, 0.0662979, -0.0243574)
bones/86/rotation = Quaternion(0.965261, -0.0155913, 0.147506, 0.215105)
bones/86/scale = Vector3(0.962756, 1.07887, 0.962756)
bones/87/rotation = Quaternion(-5.03444e-08, 0.00478933, 4.17835e-08, 0.999989)
bones/87/scale = Vector3(0.999983, 1, 0.999951)
bones/88/rotation = Quaternion(7.03193e-05, 0.00479168, -4.98721e-07, 0.999989)
bones/88/scale = Vector3(1.00048, 0.999067, 1.00052)
bones/89/rotation = Quaternion(-4.34137e-08, 0.0157254, -5.2106e-08, 0.999876)
bones/90/rotation = Quaternion(-0.470918, -0.0852096, -0.0749317, 0.874849)
bones/90/scale = Vector3(1.03764, 1.00715, 0.96196)
bones/91/rotation = Quaternion(0.0358371, 0.978653, -0.202237, 0.00738431)
bones/91/scale = Vector3(1.00024, 0.999636, 1.00013)
bones/95/position = Vector3(0.00146018, -0.02783, 0.201578)
bones/95/rotation = Quaternion(0.0220403, 0, 0, 0.999757)
bones/96/position = Vector3(1.48125e-10, 6.34203e-08, -1.66827e-07)
bones/96/rotation = Quaternion(0.711663, -0.00240419, 0.00284283, 0.702511)
bones/97/position = Vector3(-1.32131e-09, -1.34617e-07, 3.14283e-09)
bones/97/rotation = Quaternion(0.0789057, 0.00577258, -0.00843199, 0.99683)
bones/98/rotation = Quaternion(-0.0500164, 0.000806133, 0.00893315, 0.998708)
bones/100/position = Vector3(-2.15639e-05, 0.184854, 0.0376768)
bones/100/rotation = Quaternion(-0.696006, 0.00234095, -0.00289513, 0.718026)
bones/101/position = Vector3(-1.7971e-11, 9.02679e-09, 1.08236e-07)
bones/101/rotation = Quaternion(0.680829, -0.0628804, -0.056543, 0.727544)
bones/102/rotation = Quaternion(0.217126, 0.0413496, -0.00902329, 0.975226)
bones/102/scale = Vector3(1, 1, 1)
bones/103/rotation = Quaternion(-0.092573, 1.80857e-07, 4.41418e-07, 0.995706)
bones/103/scale = Vector3(0.999999, 1, 0.999999)
bones/104/rotation = Quaternion(-0.115204, 0.0416502, -0.00761882, 0.992439)
bones/104/scale = Vector3(1, 0.999998, 1)
bones/105/rotation = Quaternion(-0.698543, 0.0301334, 0.0297183, 0.714315)
bones/106/rotation = Quaternion(0.811797, 2.76976e-07, 6.24089e-08, 0.58394)
bones/107/rotation = Quaternion(-0.823708, 0.0354287, 0.0231861, 0.565431)
bones/108/position = Vector3(-1.15906e-10, 1.74131e-08, 6.15045e-08)
bones/108/rotation = Quaternion(0.722241, -1.67647e-07, -6.77814e-08, 0.691641)
bones/110/rotation = Quaternion(-2.08849e-07, -1.35333e-09, 2.85215e-09, 1)
bones/111/rotation = Quaternion(0.0108196, -2.62744e-10, -2.71807e-13, 0.999941)
bones/111/scale = Vector3(1, 0.999999, 1)
bones/115/rotation = Quaternion(-0.460104, -0.513263, -0.459437, 0.560164)
bones/116/rotation = Quaternion(-0.33531, 0.563685, -0.491081, 0.573294)
bones/116/scale = Vector3(0.985221, 0.985221, 0.985222)
bones/117/rotation = Quaternion(0.326055, 1.71522e-07, -1.15565e-07, 0.945351)
bones/117/scale = Vector3(0.998812, 0.998812, 0.998812)
bones/118/rotation = Quaternion(-0.19001, -0.145444, -0.14422, 0.960179)
bones/118/scale = Vector3(1.016, 1.016, 1.016)
bones/121/scale = Vector3(1.016, 1.016, 1.016)
bones/123/rotation = Quaternion(-3.37651e-07, -0.0739958, -1.88256e-07, 0.997259)
bones/123/scale = Vector3(1.016, 1.016, 1.016)
bones/125/scale = Vector3(1.015, 1.015, 1.015)
bones/126/rotation = Quaternion(-1.61369e-07, 0.00491775, 1.43984e-07, 0.999988)
bones/126/scale = Vector3(1.015, 1.015, 1.015)
bones/135/rotation = Quaternion(-0.21544, -0.498082, 0.834476, -0.0956582)
bones/136/rotation = Quaternion(-0.160721, 0.0038569, 0.000628132, 0.986992)
bones/136/scale = Vector3(0.985221, 0.985221, 0.985222)
bones/137/rotation = Quaternion(0.326055, 1.62912e-07, -1.08629e-07, 0.945351)
bones/137/scale = Vector3(0.998812, 0.998812, 0.998812)
bones/138/rotation = Quaternion(-0.330597, 0.569144, -0.494266, 0.567875)
bones/140/rotation = Quaternion(-0.330596, 0.569144, -0.494266, 0.567876)
bones/140/scale = Vector3(1.00747, 0.985221, 1.00747)
bones/141/rotation = Quaternion(3.60649e-08, -0.00464893, 1.3828e-07, 0.999989)
bones/142/rotation = Quaternion(0.326058, -0.00462988, 0.00158319, 0.945337)
bones/142/scale = Vector3(1.00049, 0.99069, 1.00914)
bones/143/rotation = Quaternion(-1.05145e-07, -0.0774598, -7.96062e-08, 0.996996)
bones/144/rotation = Quaternion(-0.200978, -0.071175, -0.128747, 0.968487)
bones/144/scale = Vector3(0.993284, 1.01091, 0.996091)
bones/145/rotation = Quaternion(-0.460295, 0.513086, 0.459608, 0.560029)
bones/146/rotation = Quaternion(-0.530288, -0.700422, 0.286147, 0.382521)
bones/146/scale = Vector3(0.981952, 0.981952, 0.981953)
bones/147/rotation = Quaternion(0.396818, -2.59551e-07, 1.65897e-07, 0.917898)
bones/147/scale = Vector3(0.998806, 0.998806, 0.998807)
bones/148/rotation = Quaternion(-0.206867, -0.129021, 0.177888, 0.953371)
bones/148/scale = Vector3(1.01966, 1.01966, 1.01966)
bones/151/scale = Vector3(1.01966, 1.01966, 1.01966)
bones/153/rotation = Quaternion(-1.26598e-07, -0.0659068, 1.04635e-07, 0.997826)
bones/153/scale = Vector3(1.01966, 1.01966, 1.01966)
bones/155/scale = Vector3(1.01838, 1.01838, 1.01838)
bones/156/rotation = Quaternion(-3.21385e-07, -0.000195446, -1.68137e-07, 1)
bones/156/scale = Vector3(1.01838, 1.01838, 1.01838)
bones/165/rotation = Quaternion(0.156245, -0.751027, 0.629875, 0.121672)
bones/166/rotation = Quaternion(-0.196881, -0.00383121, -0.00076952, 0.98042)
bones/166/scale = Vector3(0.981952, 0.981952, 0.981953)
bones/167/rotation = Quaternion(0.396818, -2.56692e-07, 1.66559e-07, 0.917898)
bones/167/scale = Vector3(0.998806, 0.998806, 0.998807)
bones/168/rotation = Quaternion(-0.530181, -0.700566, 0.286345, 0.382259)
bones/170/rotation = Quaternion(-0.530181, -0.700566, 0.286345, 0.382259)
bones/170/scale = Vector3(1.00915, 0.981953, 1.00915)
bones/171/rotation = Quaternion(-4.53889e-09, 0.000179539, -1.11534e-07, 1)
bones/172/rotation = Quaternion(0.396798, 0.000177651, -7.62301e-05, 0.917906)
bones/172/scale = Vector3(1.00063, 0.984556, 1.01543)
bones/173/rotation = Quaternion(-3.79349e-08, -0.0624399, 8.22235e-08, 0.998049)
bones/174/rotation = Quaternion(-0.195611, -0.0681343, 0.190889, 0.959508)
bones/174/scale = Vector3(0.994893, 1.01165, 0.993925)
bones/175/rotation = Quaternion(-0.460104, -0.513263, -0.459437, 0.560164)
bones/176/rotation = Quaternion(-0.460295, 0.513086, 0.459608, 0.560029)
bones/179/position = Vector3(-0.0698978, -0.426459, 0.117253)
bones/179/rotation = Quaternion(-0.0783462, -0.565339, 0.819373, 0.0536879)
bones/181/position = Vector3(0.588993, 1.39623, -0.595576)
bones/181/rotation = Quaternion(-0.672838, -0.0623896, -0.0571179, 0.734939)
bones/184/position = Vector3(0.0518497, 0.197807, 0.0939581)
bones/184/rotation = Quaternion(0.073548, -0.813124, 0.574626, -0.056788)
bones/186/position = Vector3(-0.313122, 1.39623, -0.74985)
bones/186/rotation = Quaternion(-0.672838, -0.0623896, -0.0571178, 0.734939)
bones/187/rotation = Quaternion(-0.337003, 5.05357e-08, 0.939611, -0.0596658)
bones/189/position = Vector3(-0.1005, 0.328732, 0.104479)
bones/189/rotation = Quaternion(0.255195, 0, 0, 0.96689)
bones/196/rotation = Quaternion(0.978729, 0.0358198, -0.00737504, -0.201874)
bones/200/position = Vector3(0.635684, 0.328412, 0.683838)
bones/200/rotation = Quaternion(-0.585249, 0.0152854, 0.0211667, 0.810433)
bones/203/position = Vector3(0.1005, -0.549219, 0)
bones/203/rotation = Quaternion(-0.136451, 0, 0, 0.990647)
bones/210/rotation = Quaternion(0.978729, -0.0358198, 0.00737505, -0.201874)
bones/213/rotation = Quaternion(1.351e-07, -7.45058e-09, 1, -2.54614e-15)
bones/214/position = Vector3(-0.545698, 0.30899, 0.742457)
bones/214/rotation = Quaternion(-0.585249, 0.0152854, 0.0211667, 0.810433)

[node name="Cube" parent="Character_Base/rig/Skeleton3D" index="0"]
material_override = SubResource("ShaderMaterial_5uy6h")

[node name="NavigationAgent3D" type="NavigationAgent3D" parent="."]
path_height_offset = 0.5

[node name="AnimationTree" type="AnimationTree" parent="."]
root_node = NodePath("../Character_Base")
tree_root = SubResource("AnimationNodeStateMachine_c4w8v")
anim_player = NodePath("../Character_Base/AnimationPlayer")
parameters/conditions/attack = false
parameters/conditions/run = false

[connection signal="area_entered" from="hurtbox" to="." method="_on_hurtbox_area_entered"]
[connection signal="area_entered" from="head_hurtbox" to="." method="_on_head_hurtbox_area_entered"]

[editable path="hitbox"]
[editable path="hurtbox"]
[editable path="head_hurtbox"]
[editable path="Character_Base"]
